"use strict";(self.webpackChunkpikachu_volleyball_p2p_online=self.webpackChunkpikachu_volleyball_p2p_online||[]).push([[792],{8007:(e,t,i)=>{var r=i(4603),n=i(6787),s=i(592),a=i(3650),o=i(9449),d=i(7561),l=i(7049),c=i(3401),h=i(8077),u=i(4697),y=i(8505),m=(i(7229),i(94)),p=i(9505),b=i(1275),I=i(6546),g=i(1514),w=i(7147),f=i(5345),P=i(1674),k=i(653);class C extends m.q{constructor(e,t){super(e,t),this.physics.player1.isComputer=!1,this.physics.player2.isComputer=!1,this.keyboardArray[0].unsubscribe(),this.keyboardArray[1].unsubscribe(),this.myKeyboard=p.Uq,this.myOnlineKeyboard=new p.Nz(this.myKeyboard.inputQueue),this.peerOnlineKeyboard=new p.Nz(b.Ix.peerInputQueue),this._amIPlayer2=!1,this.keyboardArray=[this.myOnlineKeyboard,this.peerOnlineKeyboard],this._syncCounter=0,this.noInputFrameTotal.menu=1/0,this.isFirstGame=!0,this.willSaveReplay=!0}get amIPlayer2(){return this._amIPlayer2}set amIPlayer2(e){this._amIPlayer2=e,b.Ix.amIPlayer2=e,!0===this._amIPlayer2?this.keyboardArray=[this.peerOnlineKeyboard,this.myOnlineKeyboard]:this.keyboardArray=[this.myOnlineKeyboard,this.peerOnlineKeyboard]}get syncCounter(){return this._syncCounter}set syncCounter(e){this._syncCounter=(0,I.z)(e,b.fg)}intro(){0===this.frameCounter&&(this.selectedWithWho=0,this.isFirstGame?(this.isFirstGame=!1,this.amIPlayer2=!b.Ix.amICreatedRoom):b.Ix.isQuickMatch&&(0,g.Dj)()),super.intro()}menu(){const e=this.selectedWithWho;super.menu(),this.selectedWithWho!==e&&(this.amIPlayer2=!this.amIPlayer2,(0,w.sb)(b.Ix.myNickname,this.amIPlayer2),(0,w.Si)(b.Ix.peerNickname,!this.amIPlayer2),(0,w.UI)(b.Ix.myPartialPublicIP,this.amIPlayer2),(0,w.UI)(b.Ix.peerPartialPublicIP,!this.amIPlayer2),(0,k.yL)(),(0,w.ue)())}gameLoop(){b.Ix.gameStartAllowed&&b.Ix.isOpen&&(this.myKeyboard.getInputIfNeededAndSendToPeer(this.syncCounter),this.gameLoopFromGettingPeerInput())}gameLoopFromGettingPeerInput(){if(this.peerOnlineKeyboard.isInputOnQueue(this.syncCounter)){if(this.myOnlineKeyboard.isInputOnQueue(this.syncCounter)){if(this.peerOnlineKeyboard.getInput(this.syncCounter),this.myOnlineKeyboard.getInput(this.syncCounter),this.syncCounter++,this.willSaveReplay){const e=new P.BF;e.xDirection=this.keyboardArray[0].xDirection,e.yDirection=this.keyboardArray[0].yDirection,e.powerHit=this.keyboardArray[0].powerHit;const t=new P.BF;t.xDirection=this.keyboardArray[1].xDirection,t.yDirection=this.keyboardArray[1].yDirection,t.powerHit=this.keyboardArray[1].powerHit,f.Z.recordInputs(e,t)}if(this.slowMotionFramesLeft>0){if(this.slowMotionNumOfSkippedFrames++,this.slowMotionNumOfSkippedFrames%Math.round(this.normalFPS/this.slowMotionFPS)!=0)return;this.slowMotionFramesLeft--,this.slowMotionNumOfSkippedFrames=0}this.physics.player1.isComputer=!1,this.physics.player2.isComputer=!1,this.state(),this.peerOnlineKeyboard.inputQueue.length>p.$g&&(this.myOnlineKeyboard.inputQueue.length>p.$g?window.setTimeout(this.gameLoopFromGettingPeerInput.bind(this),0):window.setTimeout(this.gameLoop.bind(this),0))}}else b.Ix.callbackAfterPeerInputQueueReceived=this.gameLoopFromGettingPeerInput.bind(this)}}var S=i(6090),E=i(6650),O=i(3398),v=i(6106);const A="isDefaultBadWordFilterEnabled",x=document.getElementById("basic-chat-filter-checkbox"),L=document.getElementById("blocked-bad-words-table-container"),F=document.querySelector("table.blocked-bad-words-table tbody"),D=document.querySelector("table.blocked-bad-words-table .delete-btn"),K=document.getElementById("number-of-bad-words-addresses"),N=document.getElementById("add-custom-word-btn"),_=document.getElementById("new-custom-word-input"),T=(0,O.j)();function B(e){if(F){for(;F.firstChild;)F.removeChild(F.firstChild);e.forEach(((e,t)=>{const i=document.createElement("tr"),r=document.createElement("td"),n=document.createElement("td");i.appendChild(r),i.appendChild(n),i.dataset.index=String(t),r.textContent=e[0],n.textContent=new Date(e[1]).toLocaleString(),F.appendChild(i)}))}}function W(){K&&(K.textContent=String(v.v.length))}const R=S.I.TEXTURES;R.WITH_COMPUTER=R.WITH_FRIEND,s.A4.registerPlugin("prepare",a.p8),s.A4.registerPlugin("batch",s.ch),h.KB.registerPlugin("prepare",y.S),h.KB.registerPlugin("sprite",u.$),d.aH.registerPlugin(l.A),r.W.RESOLUTION=2,r.W.SCALE_MODE=n.M6.NEAREST,r.W.ROUND_PIXELS=!0;const M=(0,s.q5)({width:432,height:304,antialias:!1,backgroundColor:0,backgroundAlpha:1,forceCanvas:!0}),H=new o.mc,U=new c.Rv,G=new d.aH;document.querySelector("#game-canvas-container").appendChild(M.view),M.render(H),G.add(S.I.SPRITE_SHEET);for(const e in S.I.SOUNDS)G.add(S.I.SOUNDS[e]);function Q(){const e=new C(H,G.resources);(0,g.zD)(e,U),(0,k.yg)(e),function(e){U.maxFPS=e.normalFPS,U.add((()=>{M.render(H),e.gameLoop()})),U.start()}(e)}!function(){const e=document.getElementById("loading-box"),t=document.getElementById("progress-bar");G.onProgress.add((()=>{t.style.width=`${G.progress}%`})),G.onComplete.add((()=>{e.classList.add("hidden")}))}(),b.Ix.callbackAfterDataChannelOpened=()=>{G.load(Q)},(0,g.aW)(),(0,E.G)(),function(){if(!T)return x&&x.parentElement.classList.add("hidden"),void(L&&L.classList.add("hidden"));!function(){if(!x)return;let e=!0;const t=window.localStorage.getItem(A);null!==t&&(e=JSON.parse(t)),x.checked=e,x.addEventListener("change",(()=>{try{window.localStorage.setItem(A,JSON.stringify(x.checked))}catch(e){console.log(e)}}))}(),L&&D&&F&&K&&N&&_&&(D.disabled=!0,B(v.v.createArrayView()),W(),document.body.addEventListener("click",(e=>{Array.from(F.getElementsByTagName("tr")).forEach((e=>{e.classList.remove("selected")})),D.disabled=!0;const t=e.target;F.contains(t)&&"TD"===t.tagName&&(t.parentElement.classList.add("selected"),D.disabled=!1)})),D.addEventListener("click",(()=>{const e=F.querySelector(".selected");e&&(v.v.removeAt(Number(e.dataset.index)),B(v.v.createArrayView()),W())})),N.addEventListener("click",(()=>{const e=_.value;v.v.add(e)?(B(v.v.createArrayView()),W(),_.value=""):console.log("Custom bad word add failed (duplicate, empty, or full).")})))}()}},e=>{e.O(0,[244,415,476],(()=>e(e.s=8007))),e.O()}]);
//# sourceMappingURL=main.93a52148281a9cb306b6.js.map